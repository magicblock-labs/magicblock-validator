[profile.release-with-debug]
inherits = "release"
debug = true
split-debuginfo = "packed"

[workspace]
members = [
  "sleipnir-bank",
  "sleipnir-messaging",
  "sleipnir-processor",
  "sleipnir-stage-banking",
  "sleipnir-stage-fetch",
  "sleipnir-stage-verify",
  "sleipnir-streamer",
  "sleipnir-tokens",
  "sleipnir-transaction-status",
  "solana/program-runtime",
  "solana/svm",
]

# This prevents a Travis CI error when building for Windows.
resolver = "2"

[workspace.package]
version = "1.19.0"                                               # matches Solana Version
authors = ["MagicBlock Maintainers <maintainers@magicblock.gg>"]
repository = "https://github.com/magicblock-labs/x-validator"
homepage = "https://www.magicblock.gg"
license = "Apache-2.0"
edition = "2021"

[workspace.dependencies]
arrayref = "0.3.7"
assert_matches = "1.5.0"
base64 = "0.21.7"
bincode = "1.3.3"
crossbeam-channel = "0.5.11"
csv = "1.3.0"
eager = "0.1.0"
enum-iterator = "1.5.0"
env_logger = "0.11.2"
histogram = "0.6.9"
itertools = "0.10.5"
lazy_static = "1.4.0"
libc = "0.2.153"
libsecp256k1 = "0.6.0"
log = "0.4.20"
min-max-heap = "1.3.0"
num-derive = "0.4"
num-traits = "0.2"
percentage = "0.1.0"
prio-graph = "0.2.1"
rand = "0.8.5"
rayon = "1.8.1"
rustc_version = "0.4"
serde = "1.0.196"
serde_derive = "1.0.103"
sleipnir-bank = { path = "./sleipnir-bank" }
sleipnir-messaging = { path = "./sleipnir-messaging" }
sleipnir-stage-verify = { path = "./sleipnir-stage-verify" }
sleipnir-tokens = { path = "./sleipnir-tokens" }
sleipnir-streamer = { path = "./sleipnir-streamer" }
sleipnir-transaction-status = { path = "./sleipnir-transaction-status" }
solana-accounts-db = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-accounts-db" }
solana-account-decoder = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-account-decoder" }
solana-bpf-loader-program = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-bpf-loader-program" }
solana-cost-model = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-cost-model" }
solana-frozen-abi = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-frozen-abi" }
solana-frozen-abi-macro = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-frozen-abi-macro" }
solana-loader-v4-program = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-loader-v4-program" }
solana-logger = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-logger" }
solana-measure = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-measure" }
solana-metrics = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-metrics" }
solana-perf = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-perf" }
solana-program-runtime = { path = "./solana/program-runtime" }
solana-rayon-threadlimit = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-rayon-threadlimit" }
solana-streamer = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-streamer" }
solana-sdk = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-sdk" }
solana-svm = { path = "./solana/svm" }
solana-system-program = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-system-program" }
solana-transaction-status = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-transaction-status" }
solana_rbpf = "=0.8.0"
spl-token = "=4.0.1"
spl-token-2022 = "=2.0.1"
thiserror = "1.0.57"

[patch.'https://github.com/solana-labs/solana']
solana-program-runtime = { path = "./solana/program-runtime" }
solana-svm = { path = "./solana/svm" }


[patch.crates-io]
# We include the following crates as our dependencies above from crates.io:
#
#  * spl-associated-token-account
#  * spl-instruction-padding
#  * spl-memo
#  * spl-pod
#  * spl-token
#  * spl-token-2022
#  * spl-token-metadata-interface
#
# They, in turn, depend on a number of crates that we also include directly
# using `path` specifications.  For example, `spl-token` depends on
# `solana-program`.  And we explicitly specify `solana-program` above as a local
# path dependency:
#
#     solana-program = { path = "../../sdk/program", version = "=1.16.0" }
#
# Unfortunately, Cargo will try to resolve the `spl-token` `solana-program`
# dependency only using what is available on crates.io.  Crates.io normally
# contains a previous version of these crates, and we end up with two versions
# of `solana-program` and `solana-zk-token-sdk` and all of their dependencies in
# our build tree.
#
# If you are developing downstream using non-crates-io solana-program (local or
# forked repo, or from github rev, eg), duplicate the following patch statements
# in your Cargo.toml. If you still hit duplicate-type errors with the patch
# statements in place, run `cargo update -p solana-program` and/or `cargo update
# -p solana-zk-token-sdk` to remove extraneous versions from your Cargo.lock
# file.
#
# There is a similar override in `programs/sbf/Cargo.toml`.  Please keep both
# comments and the overrides in sync.

# NOTE: in our case we don't have these crates locally, but need to ensure to point
# to the compatible versions on github
solana-program = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-program" }
solana-zk-token-sdk = { git = "https://github.com/solana-labs/solana", rev = "30adda4a71", package = "solana-zk-token-sdk" }
